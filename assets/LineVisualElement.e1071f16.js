import{cH as b,r as a,O as P,e as n,f as l,k as O,kp as R,t as f,aj as E,kl as x,G as M,eu as w,kM as $,aJ as G,D as j,kN as k,kt as V,jW as D,aR as m,iJ as g,kO as H,et as W,aq as d,kP as y,kQ as F,kR as S,kS as I,b7 as v}from"./index.f489a479.js";const N=c=>{let e=class extends b(c){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(t){this._userInteractive=t}get updating(){return!1}get visible(){return!a(this.parent)||this.parent.visible&&!this.parent.suspended}set visible(t){this._overrideIfSome("visible",t)}forceInteractiveForViewModel(){return this._interactiveViewModelCount++,P(()=>this._interactiveViewModelCount--)}};return n([l({readOnly:!0})],e.prototype,"type",void 0),n([l({constructOnly:!0})],e.prototype,"analysis",void 0),n([l({constructOnly:!0})],e.prototype,"parent",void 0),n([l({constructOnly:!0})],e.prototype,"view",void 0),n([l({type:Boolean})],e.prototype,"interactive",null),n([l()],e.prototype,"_userInteractive",void 0),n([l({readOnly:!0})],e.prototype,"updating",null),n([l()],e.prototype,"visible",null),n([l()],e.prototype,"_interactiveViewModelCount",void 0),e=n([O("esri.views.3d.analysis.AnalysisView3D")],e),e};function T(c,e,t,s=!1){const r=R(c,e);return f(r)?null:(r.hasZ&&!s||!a(t)||(r.z=E(x(t,r),0)),r)}function q(c,e,t){t.warnOnce(`Failed to project analysis geometry (id: '${c.id}'), projection from spatial reference (wkid: '${e.wkid}') to view spatial reference is not supported. Projection may be possible after calling projection.load().`)}class A{constructor(e){this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=e,this._handle=M(()=>this.view.ready,t=>{this._resourcesCreated&&(t?this._createResources():this._destroyResources())})}applyProps(e){let t=!1;for(const s in e)s in this?s==="attached"?t=e[s]:this[s]=e[s]:console.error("Cannot set unknown property",s);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources())}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.visible||this.updateVisibility(!1)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}class B extends A{constructor(e){super(e.view),this._resources=null,this._transform=w()}get object(){return a(this._resources)?this._resources.object:null}get transform(){return this._transform}set transform(e){$(this._transform,e),a(this._resources)&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(f(this._resources))return;const e=this._resources.object,t=this.view._stage;t.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),this.visible||e.setVisible(this.visible),t.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const t=new G({isPickable:!1,updatePolicy:j.SYNC});e.add(t);const s=new k({castShadow:!1});s.transformation=this._transform,this.createExternalResources(),this.createGeometries(s),e.addMany(s.geometries),this.forEachExternalMaterial(r=>e.add(r)),e.add(s),t.add(s),this.visible||s.setVisible(!1),this._resources={layer:t,object:s}}destroyResources(){const e=this.view._stage;!f(this._resources)&&e&&(e.remove(this._resources.object),e.remove(this._resources.layer),this.forEachExternalMaterial(t=>{e.remove(t),t.dispose()}),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){f(this._resources)||this._resources.object.setVisible(e)}}class z extends B{constructor(e,t){super(e),this._hasExternalMaterial=!1,this._renderOccluded=V.OccludeAndTransparent,this._width=1,this._color=D(1,0,1,1),this._innerWidth=1,this._innerColor=null,this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._writeDepthEnabled=!0,this._falloff=0,this._polygonOffset=!1,this._material=t,this._hasExternalMaterial=a(t),this.applyProps(e)}setGeometryFromRenderSpacePoint(e,t=1e3){const s=[];s.push([[e[0]-t,e[1]+0,e[2]+0],[e[0]+t,e[1]+0,e[2]+0]]),s.push([[e[0]-0,e[1]-t,e[2]+0],[e[0]+0,e[1]+t,e[2]+0]]),s.push([[e[0]-0,e[1]+0,e[2]-t],[e[0]+0,e[1]+0,e[2]+t]]),this.geometry=s}setGeometryFromExtent(e){const t=this.view.spatialReference,s=d(),r=d(),o=100,i=[];m(s,e[0],e[1],o),this.view.renderCoordsHelper.toRenderCoords(s,t,r),i.push([r[0],r[1],r[2]]),m(s,e[2],e[1],o),this.view.renderCoordsHelper.toRenderCoords(s,t,r),i.push([r[0],r[1],r[2]]),m(s,e[2],e[3],o),this.view.renderCoordsHelper.toRenderCoords(s,t,r),i.push([r[0],r[1],r[2]]),m(s,e[0],e[3],o),this.view.renderCoordsHelper.toRenderCoords(s,t,r),i.push([r[0],r[1],r[2]]),m(s,e[0],e[1],o),this.view.renderCoordsHelper.toRenderCoords(s,t,r),i.push([r[0],r[1],r[2]]),m(s,e[0],e[1],o),this.view.renderCoordsHelper.toRenderCoords(s,t,r),i.push([r[0],r[1],r[2]]),this.geometry=[i]}setGeometryFromFrustum(e){const t=[];e.lines.forEach(s=>{t.push([s.origin[0],s.origin[1],s.origin[2]]),t.push([s.endpoint[0],s.endpoint[1],s.endpoint[2]])}),this.geometry=[t]}setGeometryFromBoundedPlane(e){const t=[],s=e.origin,r=e.basis1,o=e.basis2,i=.5,h=d(),p=d(),_=d(),u=d();h[0]=s[0]-r[0]*i-o[0]*i,h[1]=s[1]-r[1]*i-o[1]*i,h[2]=s[2]-r[2]*i-o[2]*i,p[0]=s[0]-r[0]*i+o[0]*i,p[1]=s[1]-r[1]*i+o[1]*i,p[2]=s[2]-r[2]*i+o[2]*i,_[0]=s[0]+r[0]*i+o[0]*i,_[1]=s[1]+r[1]*i+o[1]*i,_[2]=s[2]+r[2]*i+o[2]*i,u[0]=s[0]+r[0]*i-o[0]*i,u[1]=s[1]+r[1]*i-o[1]*i,u[2]=s[2]+r[2]*i-o[2]*i,t.push([h[0],h[1],h[2]]),t.push([p[0],p[1],p[2]]),t.push([_[0],_[1],_[2]]),t.push([u[0],u[1],u[2]]),t.push([h[0],h[1],h[2]]),this.geometry=[t]}setGeometryFromSegment(e){const t=e.endRenderSpace;this.transform=g(C,t);const{points:s}=e.createRenderGeometry(t,this.view.renderCoordsHelper);this.geometry=[s]}setGeometryFromSegments(e,t=H){this.transform=g(C,t),this.geometry=e.map(s=>s.createRenderGeometry(t,this.view.renderCoordsHelper).points)}getTransformedGeometry(){return f(this._geometry)?null:this._geometry.map(e=>e.map(t=>W(d(),t,this.transform)))}get renderOccluded(){return a(this._material)?this._material.parameters.renderOccluded:this._renderOccluded}set renderOccluded(e){this._renderOccluded=e,a(this._material)&&this._material.setParameters({renderOccluded:e})}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return a(this._material)?this._material.parameters.width:this._width}set width(e){this._width=e,a(this._material)&&this._material.setParameters({width:e})}get color(){return a(this._material)?this._material.parameters.color:this._color}set color(e){this._color=y(e),a(this._material)&&this._material.setParameters({color:this._color})}get innerWidth(){return a(this._material)?this._material.parameters.innerWidth:this._innerWidth}set innerWidth(e){this._innerWidth=e,a(this._material)&&this._material.setParameters({innerWidth:e})}get innerColor(){return a(this._material)?this._material.parameters.innerColor:this._innerColor}set innerColor(e){this._innerColor=a(e)?y(e):e,a(this._material)&&this._material.setParameters({innerColor:this._innerColor})}get stipplePattern(){return a(this._material)?this._material.parameters.stipplePattern:this._stipplePattern}set stipplePattern(e){this._stipplePattern=e,a(this._material)&&this._material.setParameters({stipplePattern:e})}get stippleOffColor(){return a(this._material)?this._material.parameters.stippleOffColor:this._stippleOffColor}set stippleOffColor(e){this._stippleOffColor=a(e)?y(e):null,a(this._material)&&this._material.setParameters({stippleOffColor:this._stippleOffColor})}get stipplePreferContinuous(){return a(this._material)?this._material.parameters.stipplePreferContinuous:this._stipplePreferContinuous}set stipplePreferContinuous(e){this._stipplePreferContinuous=e,a(this._material)&&this._material.setParameters({stipplePreferContinuous:e})}get writeDepthEnabled(){return a(this._material)?this._material.parameters.writeDepth:this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled=e,a(this._material)&&this._material.setParameters({writeDepth:e})}get falloff(){return a(this._material)?this._material.parameters.falloff:this._falloff}set falloff(e){this._falloff=e,a(this._material)&&this._material.setParameters({falloff:e})}get polygonOffset(){return a(this._material)?this._material.parameters.hasPolygonOffset:this._polygonOffset}set polygonOffset(e){this._polygonOffset=e,a(this._material)&&this._material.setParameters({hasPolygonOffset:e})}createExternalResources(){this._hasExternalMaterial||(this._material=new F({width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,isClosed:!1,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,hasPolygonOffset:this._polygonOffset,renderOccluded:this._renderOccluded,writeDepth:this._writeDepthEnabled}))}destroyExternalResources(){this._hasExternalMaterial||(this._material=null)}createGeometries(e){for(const t of S(this.geometry)){const s=I(t);e.addGeometry(s,v(this._material))}}forEachExternalMaterial(e){this._hasExternalMaterial||e(v(this._material))}}const C=w();export{q as a,N as b,z as c,T as d,B as n,A as t};
